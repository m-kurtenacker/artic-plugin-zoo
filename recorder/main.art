#[import(cc = "plugin", name = "wrap_token")] fn wrap_token(_token: fn() -> i32, _expr: fn (i32) -> i32) -> ();
#[import(cc = "plugin", name = "generate_token", depends = wrap_token)] fn generate_token(_expr: fn () -> i32) -> fn () -> i32;

#[export]
fn main (_argc : i32, _argv : &[&[u8]]) -> i32 {
    let token = generate_token(|| { 0 });

    for i in unroll(0, 2) {
        wrap_token(token, @|x| { x + 1 });
    }

    let a = token();
    a
}
